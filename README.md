# SmartServiceHub
A full-stack Java + Preact service marketplace with AI-powered recommendations and real-time chat.
You can create a service post to request a service and other users can comment and accept your proposal. 


## Table of Contents

- [SmartServiceHub](#smartservicehub)
- [Dependencies](#dependencies)
- [Recommended](#recommended)
- [Getting Started](#getting-started)
- [Scripts](#scripts)
- [Authentication](#authentication)
- [Models](#models)
  - [User](#user)
  - [ServicePost](#servicepost)
  - [Comment](#comment)
  - [Others](#others)
- [CORS Policy](#cors-policy)
- [Endpoints](#endpoints)
  - [User Endpoints](#user-endpoints)
  - [App Services Endpoints](#app-services-endpoints)
  - [Comments Endpoints](#comments-endpoints)
  - [Roles](#roles)
- [Addons](#addons)
  - [Hooks / Events](#hooks--events)
  - [List of Events](#list-of-events)
- [Methods](#methods)
  - [Network](#network)
- [Features](#features)
  - [Implemented](#implemented)
  - [TODO](#todo)

## Dependencies 
- Java 21
- NodeJS
- npm
- Postgres
- Git

## Recommended
- Postman

## Getting Started
1. install dependencies
2. clone the repo
3. create a db in postgres with the name "servicehub_dev". You can also change the name of the db in "/SmartServiceHub-backend/src/main/resource/db.env"
4. run the start.sh script
5. if it works ignore 6 trough 9 included
6. go to ./SmartServiceHub/SmartServiceHub-backend
7. run "mvn spring-boot:run"
8. go to ./SmartServiceHub/SmartServiceHub-frontend/src/frontend
9. run "npm run dev"
10. click on the URL generated by node
11. You can test the backend at "http://localhost:8080/"
12. Frontend at "http://localhost:5173"

## Scripts
- Various scripts can be found under /scripts
- start_backend.sh and start_frontend.sh start the backend and frontend individually
- env_check tells you wich programs you have or are missing that are needed for the project to work
- port_check tells you wich ports are in use and if you can use them
- checker.sh runs all checks

## Authentication
This app uses basic autentication / autorization were Username is the username and password is the passoword altough this is likelly to change in the future.
Some endpoints will require authentication, these can be seen at "/config/SecurityConfig.java" or in their respective controllers from the notations.
Accounts may be USER or ADMIN.
When the program is ran, it will automatically create an ADMIN user with the name "admin" and password "admin123", this can be changed in "/config/DataInitialization.java".

# Models
## User
- AppUser <- user model to interact with db 
- UserPublicDto <- user model for showing (hides password)
- UserCreateDto <- user model for creation
## ServicePost
- ServicePost <- Service post model to interact with db
- ServicePostPublicDto <- Service post model for showing 
- ServicePostCreateDto <- Service post model from creation
## Comment
- Comment <- comment model for interaction with db
- CommentCreateDto <- comment model for creation
- CommentPublicDto <- comment model for showing
## Others
- ApiResponse <- model for responding to requests, however this must be changed in the future as it is a source of inconsistencies
- Roles <- Enum for roles "ADMIN, USER, MODERATOR"1

## CORS Policy
Currently this app allows CORS from all sources tough this can be changed at "/config/WebConfig.java"

# Endpoints
The frontend and backend communicate trough REST api using json
A list of all endpoints can be found under the folder "controllers" or listed at "http://localhost:8080/home"

## User Endpoints
- /users POST <- creates a user, users are created like 
```JSON 
{"username": "name", "email": "mail@mail.com", "password": "password123"} 
```
- /users/{id} GET <- gets a public user by id 
- /users GET <- requires admin loggin, gets a list of all users
- /users/{id} PUT <- updates a user by id, requires you to be logged in as the user you are trying to update, syntax is similar to POST
- /users DELETE <- deletes a user by id, requires you to be logged in as the user you are trying to delete
- /users/unique?limit=int&offset=int GET <- gets unique public users based on a limit and offset 

## App Services Endpoints
- /services POST <- creates a post, must be logged in. Post are created like 
```JSON
{"title": "title", "content": "Stuffs"}
```
- /services GET <- gets a list of all services 
- /services/{id} GET <- gets a service by id
- /services/limit/{limit} GET <- gets a list of services of size {limit}
- /services/{id} PUT <- updates a service by id, must be logged in as the user who created the post
- /services/{id} DELETE <- deletes a service by id, must be logged in as the user who created the service
- /services/unique?limiy=int&offset=int GET <- gets a unique public list of services based on limit and offset

## Comments Endpoints
- to be written

# Roles
- Users can have 3 roles currently, USER, ADMIN, MODERATOR wich can be found at the roles enum in the backend
- USER is the basic user, has access to the basic features ,can only update and delete its own content and can be created by anyone
- ADMIN users can delete, update and get detailed information from the DB, these can only be created from the first ADMIN user that is created when the app launches
- MODERATOR users are currently unimplemented but they will have the tools to moderate content without having access to potentially destructive tools

# Addons
- this app provides extensability via Lua scripts
- you can write you own scripts at SmartServiceHub/scripts
## Hooks / Events
- your scripts can react to program events trough provided hooks
- you can subscribe a function to an event like 
```Lua
register_event {
    event = "eventName",
    func = function()
        ...
    end
}
```
## List of Events
### Startup
- onAppStartup(null)
### Home
- onHomeAccessed(String)
### Users
- onUserCreate(AppUser)
- onGetUserId(UserPublicDto)
- onUpdateUserById(AppUser)
- onDeleteUserById(null)
- onGetUniqueUsers(List<UserPublicDto>)
### Admin
- onDeleteAllPosts
- onDeleteAllComments
- onDeleteAllUsers
- onAdminCreate
### ServicePost
- onGetUniqueServicePost
- onDeleteServiceByPostId
- onUpdateService
- onGetServiceById
- onAppServiceCreate
### Comment
- onGetUniqueComments
- onGetCommentsFromPost
- onDeleteCommentById
- onUpdateComment
- onGetCommentById
- onCreateComment

## Methods
- The program also exposes some java classes and methods that lua can call

## List of Methods
### Network
- static String httpGet(String urlStr) 
- static String httpPost(String urlStr, String data)

# Features
### Implemented
- User creation
- Post creation
- Comment creation
- User autentication
- Roles
- Lua script events
### TODO
- AI integration
- Frontend implementation
- Adaptive recomendations
- Docker integration (by at least october)
- Tests
- Chat
- Job acceptance
- Skill matching
